<html lang="en" class="govuk-template ">
<head>
  <meta charset="utf-8">
  <title>
    Login
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#0b0c0c">
  <link rel="shortcut icon" sizes="16x16 32x32 48x48" href="{StorageAccountUrl}{B2cContainer}/favicon.ico"
        type="image/x-icon">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <script>
    localStorage.setItem('errorDisplayed', 'no');
  </script>

</head>
<body>
<script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>


<a href="#main-content" class="govuk-skip-link">Skip to main content</a>


<header class="govuk-header " role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-width-container">
    <div class="govuk-header__logo">
      <a href="https://www.gov.uk/" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__logotype">
          <img src="{StorageAccountUrl}{B2cContainer}/logo_gov.png" height="30" width="36"
               class="govuk-header__logotype-crown-fallback-image"/>
          <span class="govuk-header__logotype-text">
            GOV.UK
          </span>
        </span>

      </a>
    </div>

    <div class="govuk-header__content">

      <a href="https://{WebsiteUrl}/view-option" class="govuk-header__link govuk-header__link--service-name">
        Court and tribunal hearings
      </a>


    </div>

  </div>
</header>


<div class="govuk-width-container ">
  <div class="govuk-phase-banner">
    <p class="govuk-phase-banner__content">
      <strong class="govuk-tag govuk-phase-banner__content__tag">
        beta
      </strong>
      <span class="govuk-phase-banner__text">
      This is a new service – your <a id="betalink" class="govuk-link"
                                      href="https://www.smartsurvey.co.uk/s/FBSPI22/?pageurl=b2c/reset-pw">feedback</a> will help us to improve it.
    </span>
    </p>
  </div>

  <nav class="moj-sub-navigation pub-navigation govuk-!-margin-bottom-0" aria-label="Primary navigation">

    <ul class="moj-sub-navigation__list">
      <li class="moj-sub-navigation__item">
        <a class="moj-sub-navigation__link" href="https://{WebsiteUrl}/">Home</a>
    </ul>

  </nav>

  <main class="govuk-main-wrapper " id="main-content" role="main">

    <link href="{StorageAccountUrl}{B2cContainer}/reset-pw.css" rel="stylesheet">
    <div class="govuk-grid-row">
      <div id="api" data-name="SelfAsserted" class="govuk-grid-column-two-thirds">
        <div class="buttons">
        </div>
        <div class="intro"><h2>Please provide the following details.</h2></div>
        <form id="attributeVerification" action="JavaScript:void(0);">
          <div id="passwordEntryMismatch" class="error pageLevel" style="display: none;" aria-hidden="true">The password
            entry fields do not match. Please enter the same password in both fields and try again.
          </div>
          <div id="requiredFieldMissing" class="error pageLevel" style="display: none;" aria-hidden="true">A required
            field is missing. Please fill out all required fields and try again.
          </div>
          <div id="fieldIncorrect" class="error pageLevel" style="display: none;" aria-hidden="true">One or more fields
            are filled out incorrectly. Please check your entries and try again.
          </div>
          <div id="claimVerificationServerError" class="error pageLevel" style="display: none;"
               aria-hidden="true"></div>
          <div id="attributeList" class="attr">
            <ul>
              <li class="Password">
                <div class="attrEntry"><label id="newPassword_label" for="newPassword">New Password</label>
                  <div class="passwordAdvice"><p></p></div>
                  <div class="error itemLevel" role="alert"></div>
                  <input id="newPassword" class="textInput" type="password" placeholder="New Password"
                         aria-label="New Password"
                         pattern="^((?=.*[a-z])(?=.*[A-Z])(?=.*\d)|(?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])|(?=.*[a-z])(?=.*\d)(?=.*[^A-Za-z0-9])|(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]))([A-Za-z\d@#$%^&amp;*\-_+=[\]{}|\\:',?/`~&quot;();!]|\.(?!@)){8,16}$"
                         title="Enter new password" autocomplete="new-password" aria-required="true"
                         autofocus="autofocus" required>
                  <a class="helpLink tiny" href="javascript:void(0)" data-help="Enter new password">What is this?</a>
                </div>
              </li>

              <li class="Password">
                <div class="attrEntry"><label id="reenterPassword_label" for="reenterPassword">Confirm New
                  Password</label>
                  <div class="error itemLevel" role="alert"></div>
                  <input id="reenterPassword" class="textInput" type="password" placeholder="Confirm New Password"
                         aria-label="Confirm New Password"
                         pattern="^((?=.*[a-z])(?=.*[A-Z])(?=.*\d)|(?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])|(?=.*[a-z])(?=.*\d)(?=.*[^A-Za-z0-9])|(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]))([A-Za-z\d@#$%^&amp;*\-_+=[\]{}|\\:',?/`~&quot;();!]|\.(?!@)){8,16}$"
                         title="Confirm new password" autocomplete="new-password" aria-required="true">
                  <a class="helpLink tiny" href="javascript:void(0)" data-help="Confirm new password">What is this?</a>
                </div>
              </li>
            </ul>
          </div>
          <div class="buttons">
            <button id="continue" type="submit" form="attributeVerification" aria-disabled="false"
                    aria-label="Continue">Continue
            </button>
            <button id="cancel" aria-label="Cancel" formnovalidate="">Cancel</button>
          </div>

          <div class="verifying-modal">
            <div id="verifying_blurb"></div>
          </div>
        </form>

      </div>
      <div class="govuk-grid-column-one-third" id="hidden">
        <h2 style="font-family: Arial; margin-top:30px;">Password must contain the following:</h2>
        <p style="font-size: large" id="length" class="invalid">8 - 16 Characters in length</p>
        <p style="font-size: large" id="letter" class="invalid">a lowercase character letter</p>
        <p style="font-size: large" id="capital" class="invalid">uppercase character letter</p>
        <p style="font-size: large" id="number" class="invalid">a digit (0-9) or any of the following symbols<br>@ # $ %
          ^ &amp; * - _ + = []
          {} | \ : ' , ? / ` ~ " () ; .</p>
      </div>
    </div>
  </main>
</div>


<footer class="govuk-footer " role="contentinfo">
  <div class="govuk-width-container ">

    <div class="govuk-footer__meta">
      <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">

        <h2 class="govuk-visually-hidden">Support links</h2>

        <ul class="govuk-footer__inline-list">
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://gov.uk/help">
              Help
            </a>
          </li>
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://gov.uk/help/privacy-notice">
              Privacy
            </a>
          </li>
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://{WebsiteUrl}/Cookie-policy">
              Cookies
            </a>
          </li>
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://{WebsiteUrl}/accessibility-statement">
              Accessibility statement
            </a>
          </li>
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://gov.uk/contact">
              Contact
            </a>
          </li>
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://www.gov.uk/help/terms-conditions">
              Terms and conditions
            </a>
          </li>
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://www.gov.uk/cymraeg">
              Welsh
            </a>
          </li>
          <li class="govuk-footer__inline-list-item">
            <a class="govuk-footer__link" href="https://www.gov.uk/government/organisations/government-digital-service">
              Government Digital Service
            </a>
          </li>
        </ul>

        <img src="{StorageAccountUrl}{B2cContainer}/copyright.png" height="17" width="41"
             class="govuk-footer__licence-logo"/>
        <span class="govuk-footer__licence-description">
          All content is available under the
          <a class="govuk-footer__link"
             href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated
        </span>
        <p class="govuk-footer__licence-description">When you use this information under the OGL,
          you should include the following attribution: Contains public sector information licensed under the
          <a class="govuk-footer__link"
             href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
             rel="license">Open Government Licence v3.0</a>
        </p>
        <p class="govuk-footer__licence-description govuk-!-margin-0">The
          <a class="govuk-footer__link"
             href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
             rel="license">Open Government Licence v3.0</a> does not cover use of any personal data in the
          court and tribunal hearings service. Personal data is subject to applicable data protection laws.
        </p>
      </div>
      <div class="govuk-footer__meta-item">
        <a class="govuk-footer__link govuk-footer__copyright-logo"
           href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/">©
          Crown copyright</a>
      </div>
    </div>
  </div>
</footer>

<script>
  function replaceHeadingWithH2() {
    const heading = document.querySelector('.intro');
    const headingText = heading.querySelector('p').innerHTML;

    const replacementHeadingElement = document.createElement('h2');
    const replacementText = document.createTextNode(headingText);
    replacementHeadingElement.appendChild(replacementText);

    heading.innerHTML = '';
    heading.appendChild(replacementHeadingElement);
  }

  function setPasswordAdvice() {
    const passwordLabel = document.getElementById('newPassword_label');

    if (passwordLabel) {
      const passwordAdvice = document.createElement('p');
      const text = document.createTextNode('Your password must be 8-16 characters in length and contain 3 out of the 4 following: a lowercase character, uppercase character, a digit (0-9) or one or more of the following symbols @ # $ % ^ & * - _ + = [ ] { } | \\ : \' , ? / ` ~ " ( ) ; .');
      passwordAdvice.appendChild(text);

      const div = document.createElement('div');
      div.className = 'passwordAdvice';
      div.appendChild(passwordAdvice);

      passwordLabel.parentNode.insertBefore(div, passwordLabel.nextSibling)
    }
  }

  replaceHeadingWithH2();
  setPasswordAdvice();
</script>

<script>
  function addGovukErrorSummary(headingErrors, verificationErrors) {
    const errorTitle = document.createElement('h2');
    errorTitle.className = 'govuk-error-summary__title';
    const titleText = document.createTextNode('There is a problem');
    errorTitle.appendChild(titleText);

    const errorBodyDiv = document.createElement('div');
    errorBodyDiv.className = 'govuk-error-summary__body';
    const errorCount = headingErrors.length;

    // The appendChild() method move the element after appending, hence we always use element index zero when accessing the next element.
    for (let i = 0; i < errorCount; i++) {
      errorBodyDiv.appendChild(headingErrors[0]);
    }

    if (verificationErrors.length > 0) {
      errorBodyDiv.appendChild(verificationErrors[0]);
    }

    const roleAlertDiv = document.createElement('div');
    roleAlertDiv.setAttribute("role", "alert");
    roleAlertDiv.appendChild(errorTitle);
    roleAlertDiv.appendChild(errorBodyDiv);

    const errorSummaryDiv = document.createElement('div');
    errorSummaryDiv.className = 'govuk-error-summary';
    errorSummaryDiv.appendChild(roleAlertDiv);

    const mainForm = document.getElementById('attributeVerification');
    mainForm.prepend(errorSummaryDiv);
  }

  function createErrorSummaryBox() {
    let displayError = false;
    const errorSummary = document.getElementsByClassName("govuk-error-summary");
    const headingErrors = document.getElementsByClassName("error pageLevel");
    const verificationErrors = document.getElementsByClassName('verificationErrorText error');

    if (localStorage.getItem('errorDisplayed') === 'no'
      && errorSummary.length == 0) {
      for (let i = 0; i < headingErrors.length; i++) {
        if (window.getComputedStyle(headingErrors[i]).style !== 'none') {
          displayError = true;
          localStorage.setItem('errorDisplayed', 'yes');
        }
      }

      if (!displayError
        && verificationErrors.length > 0
        && window.getComputedStyle(verificationErrors[0]).style !== 'none') {
        displayError = true;
        localStorage.setItem('errorDisplayed', 'yes');
      }
    }

    if (displayError) {
      addGovukErrorSummary(headingErrors, verificationErrors);
    }
  }

  function removeErrorSummaryBox() {
    const errorSummary = document.getElementsByClassName("govuk-error-summary");

    if (localStorage.getItem('errorDisplayed') === 'yes' && errorSummary.length > 0) {
      const errorTitle = document.getElementsByClassName("govuk-error-summary__title");
      if (errorTitle.length > 0) {
        errorTitle[0].remove();
      }

      const headingErrors = document.getElementsByClassName("error pageLevel");
      const mainForm = document.getElementById('attributeVerification');
      const errorCount = headingErrors.length;

      for (let i = 0; i < errorCount; i++) {
        mainForm.prepend(headingErrors[i]);
      }

      const verificationErrors = document.getElementsByClassName('verificationErrorText error');
      const verificationControl = document.getElementById('emailVerificationControl');
      if (verificationErrors.length > 0) {
        verificationControl.prepend(verificationErrors[0]);
      }

      while (errorSummary.length > 0) {
        errorSummary[0].parentNode.removeChild(errorSummary[0]);
      }
      localStorage.setItem('errorDisplayed', 'no');
    }
  }

  function observerCallback(mutationList, observer) {
    const displayNone = 'display: none;';
    const displayBlock = 'display: block;';
    const displayInline = 'display: inline;';

    for (const mutation of mutationList) {
      const currentDisplay = mutation.target.getAttribute(mutation.attributeName);
      if (mutation.oldValue === displayNone
        && (currentDisplay === displayBlock || currentDisplay === displayInline)) {
        createErrorSummaryBox();
      } else if ((mutation.oldValue === displayBlock && currentDisplay === displayNone)
        || (mutation.oldValue === displayInline && currentDisplay === displayNone)) {
        removeErrorSummaryBox();
      }
    }
  }

  const config = {
    attributes: true,
    attributeFilter: ["style"],
    attributeOldValue: true
  };
  const observer = new MutationObserver(observerCallback);

  const headingErrors = document.getElementsByClassName("error pageLevel");
  for (let i = 0; i < headingErrors.length; i++) {
    observer.observe(headingErrors[i], config);
  }

  const verificationError = document.getElementById('emailVerificationControl_error_message');
  if (verificationError) {
    observer.observe(verificationError, config);
  }

  function modalTimeoutCallback() {
    setTimeout(
      function () {
        const modalOverlay = document.getElementById('simplemodal-overlay');
        const modalContainer = document.getElementById('simplemodal-container');

        if (document.contains(modalOverlay) && document.contains(modalContainer)) {
          modalOverlay.style.setProperty('display', 'block', 'important');
          modalContainer.style.setProperty('display', 'block', 'important');
        }
      }, 5000);
  }

  const timeoutConfig = {
    attributes: true,
    attributeFilter: ["id"],
    attributeOldValue: true
  };


  const timeoutObserver = new MutationObserver(modalTimeoutCallback);
  const verifyingModal = document.getElementsByClassName("verifying-modal");
  timeoutObserver.observe(verifyingModal[0], timeoutConfig);

  var password = document.getElementById("newPassword");
  var confirm_password = document.getElementById("reenterPassword");
  var length = document.getElementById("length");
  var letter = document.getElementById("letter");
  var capital = document.getElementById("capital");
  var number = document.getElementById("number");

  // When the user clicks on the password field, show the message box
  password.onfocus = function () {
    document.getElementById("message").style.display = "block";
  }

  // When the user clicks outside of the password field, hide the message box
  password.onblur = function () {
    document.getElementById("message").style.display = "none";
  }

  // When the user starts to type something inside the password field
  password.onkeyup = function () {

    // Validate lowercase letters
    var lowerCaseLetters = /[a-z]/g;
    if (password.value.match(lowerCaseLetters)) {
      letter.classList.remove("invalid");
      letter.classList.add("valid");
    } else {
      letter.classList.remove("valid");
      letter.classList.add("invalid");
    }

    // Validate capital letters
    var upperCaseLetters = /[A-Z]/g;
    if (password.value.match(upperCaseLetters)) {
      capital.classList.remove("invalid");
      capital.classList.add("valid");
    } else {
      capital.classList.remove("valid");
      capital.classList.add("invalid");
    }

    // Validate numbers
    var numbers = /[0-9]/g;
    if (password.value.match(numbers)) {
      number.classList.remove("invalid");
      number.classList.add("valid");
    } else {
      number.classList.remove("valid");
      number.classList.add("invalid");
    }

    // Validate length
    if (password.value.length >= 8) {
      length.classList.remove("invalid");
      length.classList.add("valid");
    } else {
      length.classList.remove("valid");
      length.classList.add("invalid");
    }
  }

</script>

</body>
</html>
